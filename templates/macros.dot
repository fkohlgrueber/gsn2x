{%- macro render_box(id, node) -%}
  {%- set wrap = 60 -%}
  shape={%- if   id is starting_with("G") %}"box"
        {%- elif id is starting_with("A") %}"oval"
        {%- elif id is starting_with("J") %}"oval"
        {%- elif id is starting_with("C") %}"box"
        {%- elif id is starting_with("Sn") %}"circle"{%- set wrap = 15 -%}
        {%- elif id is starting_with("S") %}"parallelogram"
        {%- endif %}

        {%- if id is starting_with("C") %}, style="rounded"{%- endif %}{%- if node["url"] %}, URL="{{ node["url"] }}"{%- endif %}, label=<<B>{{id}}</B><BR align="left"/>{{ node.text|trim_end|wordwrap(width=wrap,wrapstr='<BR align="left"/>') }}
        {%- if layers %}
          {%- for layer in layers %}
            {%- if node[layer] %}<BR align="left"/><I>{{ layer | upper }}</I>:{{ node[layer]|trim_end|wordwrap(width=wrap,wrapstr='<BR align="left"/>') }}{%- endif %}
          {%- endfor %}
        {%- endif %}>
        
{%- endmacro %}
